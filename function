import math
import numpy as np
import scipy.special
from scipy.special import sph_harm


#hydrogen wave function
def hydrogen_wf(n,l,m,X,Y,Z):
    R = np.sqrt(X**2+Y**2+Z**2)
    Theta = np.arccos(Z/R)
    Phi = np.arctan2(Y,X)
    
    rho = 2.*R/n
    s_harm=sph_harm(m, l, Phi, Theta)
    l_poly = scipy.special.genlaguerre(n-l-1,2*l+1)(rho)
    
    prefactor = np.sqrt((2./n)**3*math.factorial(n-l-1)/(2.*n*math.factorial(n+l)))
    wf = prefactor*np.exp(-rho/2.)*rho**l*s_harm*l_poly
    wf = np.nan_to_num(wf)
    return wf

#function which calculate the maximum value in a numpy array
def maximum_3array(a,b,c): 
    maximum = max(a)
    if maximum < max(b):
        maximum = max(b)
    if maximum < max(c):
        maximum = max(c)
    return maximum 

#function which separate coordinates according to the distance with the origin
def separate_data_by_probability(lim_min,lim_max,x,y,z): 
    x_reduc = []
    y_reduc = []
    z_reduc = []
    for i in range(len(x)):
        r = np.sqrt(x[i]**2+y[i]**2+z[i]**2)
        if lim_min < r < lim_max :
            x_reduc.append(x[i])
            y_reduc.append(y[i])
            z_reduc.append(z[i])
    return x_reduc, y_reduc, z_reduc
